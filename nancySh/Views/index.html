<html>
<head>
    <title>Portraits</title>
    <link rel="stylesheet" type="text/css" href="/Content/bootstrap.min.css"/>
</head>
<body>

<script src="/js/jquery-2.2.0.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/mustache.min.js"></script>

<script>
var App = {
    reload: function () {
        $.get("list", function (data) {
            var template = $("#list-tmpl").html();
            Mustache.parse(template);
            $("#list").html(Mustache.render(template, { tests: data }));
        });
    },
    update: function (id, version) {
        $.post("update", { Id: id, Version: version, Val: $("#val" + id).val() }, App.reload);
    },
    delete: function (id, version) {
        $.post("delete/" + id + "/" + version, null, App.reload);
    },
    newItem: function () {
        $.post("new", null, App.reload);
    }
};
$(App.reload);
</script>

<div class="header col-xs-12">
    <h1><a onclick="App.reload();" href="javascript:void;">Hello!</a></h1>
</div>

<div class="col-xs-12">
<input type="button" value="New item" onclick="App.newItem();"/>
</div>

<div id="list" class="col-lg-4">
</div>

<script type="text/template" id="list-tmpl">
    <table class="table">
    {{#tests}}
        <tr>
            <td>
                {{id}}
            </td>
            <td>
                <form id="form{{id}}">
                    <input id="val{{id}}" type="text" value="{{val}}"/>
                    <input type="button" value="Edit"
                        onclick="App.update({{id}},{{version}})"/>
                </form>
            </td>
            <td>
                <input type="button" value="Delete"
                    onclick="App.delete({{id}},{{version}})"/>
            </td>
        </tr>
    {{/tests}}
    </table>
</script>

</body>
</html>